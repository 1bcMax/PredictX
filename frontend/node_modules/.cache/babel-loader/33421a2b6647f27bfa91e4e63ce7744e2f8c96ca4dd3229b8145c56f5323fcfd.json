{"ast":null,"code":"import { isMobile as t, isIOS as e } from \"react-device-detect\";\nimport { openHref as i } from \"../connectors/walletconnect-registry.mjs\";\nimport { RunEffectOnce as n } from \"../effect.mjs\";\nimport { PrivyClientError as s, formatApiError as a } from \"../errors.mjs\";\nimport { farcasterAuthenticatePath as o, farcasterLinkPath as h, farcasterInitPath as r, farcasterStatusPath as c } from \"../paths.mjs\";\nimport \"../storage.mjs\";\nimport \"../utils/index.mjs\";\nimport \"../connectors/get-legacy-injected-providers.mjs\";\nimport \"../connectors/is-wallet-installed.mjs\";\nimport \"../utils/eth/getPublicClient.mjs\";\nimport \"viem\";\nimport \"ofetch\";\nclass l {\n  get meta() {\n    return this._meta;\n  }\n  async authenticate() {\n    if (!this.api) throw new s(\"Auth flow has no API instance\");\n    if (!this.meta.channelToken) throw new s(\"Auth flow must be initialized first\");\n    try {\n      let t = await this.api.post(o, {\n        channel_token: this.meta.channelToken,\n        message: this.message,\n        signature: this.signature,\n        fid: this.fid,\n        mode: this.meta.disableSignup ? \"no-signup\" : \"login-or-sign-up\"\n      });\n      if (!t) throw new s(\"No response from authentication\");\n      return t;\n    } catch (t) {\n      throw a(t);\n    }\n  }\n  async link() {\n    if (!this.api) throw new s(\"Auth flow has no API instance\");\n    try {\n      return await this.api.post(h, {\n        channel_token: this.meta.channelToken,\n        message: this.message,\n        signature: this.signature,\n        fid: this.fid\n      });\n    } catch (t) {\n      throw a(t);\n    }\n  }\n  async _startChannelOnce() {\n    if (!this.api) throw new s(\"Auth flow has no API instance\");\n    let n = await this.api.post(r, {\n      token: this.captchaToken\n    });\n    t && !e && n.connect_uri && i(n.connect_uri, \"_blank\"), this._meta = {\n      ...this._meta,\n      connectUri: n.connect_uri,\n      channelToken: n.channel_token\n    };\n  }\n  async initializeFarcasterConnect() {\n    if (!this.api) throw new s(\"Auth flow has no API instance\");\n    await this.startChannelOnce.execute();\n  }\n  async _pollForReady() {\n    if (!this.api) throw new s(\"Auth flow has no API instance\");\n    if (!this.meta.channelToken) throw new s(\"Auth flow must be initialized first\");\n    let t = await this.api.get(c, {\n      headers: {\n        \"farcaster-channel-token\": this.meta.channelToken\n      }\n    });\n    return \"completed\" === t.state && (this.message = t.message, this.signature = t.signature, this.fid = t.fid, !0);\n  }\n  constructor(t, e = !1) {\n    this._meta = {\n      disableSignup: !1\n    }, this.captchaToken = t, this.startChannelOnce = new n(this._startChannelOnce.bind(this)), this.pollForReady = new n(this._pollForReady.bind(this)), this._meta.disableSignup = e;\n  }\n}\nexport { l as FarcasterFlow };","map":{"version":3,"names":["isMobile","t","isIOS","e","openHref","i","RunEffectOnce","n","PrivyClientError","s","formatApiError","a","farcasterAuthenticatePath","o","farcasterLinkPath","h","farcasterInitPath","r","farcasterStatusPath","c","l","meta","_meta","authenticate","api","channelToken","post","channel_token","message","signature","fid","mode","disableSignup","link","_startChannelOnce","token","captchaToken","connect_uri","connectUri","initializeFarcasterConnect","startChannelOnce","execute","_pollForReady","get","headers","state","constructor","bind","pollForReady","FarcasterFlow"],"sources":["/Users/vickyfu/Documents/PredictX/frontend/node_modules/@privy-io/react-auth/dist/esm/auth-flows/farcaster.mjs"],"sourcesContent":["import{isMobile as t,isIOS as e}from\"react-device-detect\";import{openHref as i}from\"../connectors/walletconnect-registry.mjs\";import{RunEffectOnce as n}from\"../effect.mjs\";import{PrivyClientError as s,formatApiError as a}from\"../errors.mjs\";import{farcasterAuthenticatePath as o,farcasterLinkPath as h,farcasterInitPath as r,farcasterStatusPath as c}from\"../paths.mjs\";import\"../storage.mjs\";import\"../utils/index.mjs\";import\"../connectors/get-legacy-injected-providers.mjs\";import\"../connectors/is-wallet-installed.mjs\";import\"../utils/eth/getPublicClient.mjs\";import\"viem\";import\"ofetch\";class l{get meta(){return this._meta}async authenticate(){if(!this.api)throw new s(\"Auth flow has no API instance\");if(!this.meta.channelToken)throw new s(\"Auth flow must be initialized first\");try{let t=await this.api.post(o,{channel_token:this.meta.channelToken,message:this.message,signature:this.signature,fid:this.fid,mode:this.meta.disableSignup?\"no-signup\":\"login-or-sign-up\"});if(!t)throw new s(\"No response from authentication\");return t}catch(t){throw a(t)}}async link(){if(!this.api)throw new s(\"Auth flow has no API instance\");try{return await this.api.post(h,{channel_token:this.meta.channelToken,message:this.message,signature:this.signature,fid:this.fid})}catch(t){throw a(t)}}async _startChannelOnce(){if(!this.api)throw new s(\"Auth flow has no API instance\");let n=await this.api.post(r,{token:this.captchaToken});t&&!e&&n.connect_uri&&i(n.connect_uri,\"_blank\"),this._meta={...this._meta,connectUri:n.connect_uri,channelToken:n.channel_token}}async initializeFarcasterConnect(){if(!this.api)throw new s(\"Auth flow has no API instance\");await this.startChannelOnce.execute()}async _pollForReady(){if(!this.api)throw new s(\"Auth flow has no API instance\");if(!this.meta.channelToken)throw new s(\"Auth flow must be initialized first\");let t=await this.api.get(c,{headers:{\"farcaster-channel-token\":this.meta.channelToken}});return\"completed\"===t.state&&(this.message=t.message,this.signature=t.signature,this.fid=t.fid,!0)}constructor(t,e=!1){this._meta={disableSignup:!1},this.captchaToken=t,this.startChannelOnce=new n(this._startChannelOnce.bind(this)),this.pollForReady=new n(this._pollForReady.bind(this)),this._meta.disableSignup=e}}export{l as FarcasterFlow};\n"],"mappings":"AAAA,SAAOA,QAAQ,IAAIC,CAAC,EAACC,KAAK,IAAIC,CAAC,QAAK,qBAAqB;AAAC,SAAOC,QAAQ,IAAIC,CAAC,QAAK,0CAA0C;AAAC,SAAOC,aAAa,IAAIC,CAAC,QAAK,eAAe;AAAC,SAAOC,gBAAgB,IAAIC,CAAC,EAACC,cAAc,IAAIC,CAAC,QAAK,eAAe;AAAC,SAAOC,yBAAyB,IAAIC,CAAC,EAACC,iBAAiB,IAAIC,CAAC,EAACC,iBAAiB,IAAIC,CAAC,EAACC,mBAAmB,IAAIC,CAAC,QAAK,cAAc;AAAC,OAAM,gBAAgB;AAAC,OAAM,oBAAoB;AAAC,OAAM,iDAAiD;AAAC,OAAM,uCAAuC;AAAC,OAAM,kCAAkC;AAAC,OAAM,MAAM;AAAC,OAAM,QAAQ;AAAC,MAAMC,CAAC;EAAC,IAAIC,IAAIA,CAAA,EAAE;IAAC,OAAO,IAAI,CAACC,KAAK;EAAA;EAAC,MAAMC,YAAYA,CAAA,EAAE;IAAC,IAAG,CAAC,IAAI,CAACC,GAAG,EAAC,MAAM,IAAIf,CAAC,CAAC,+BAA+B,CAAC;IAAC,IAAG,CAAC,IAAI,CAACY,IAAI,CAACI,YAAY,EAAC,MAAM,IAAIhB,CAAC,CAAC,qCAAqC,CAAC;IAAC,IAAG;MAAC,IAAIR,CAAC,GAAC,MAAM,IAAI,CAACuB,GAAG,CAACE,IAAI,CAACb,CAAC,EAAC;QAACc,aAAa,EAAC,IAAI,CAACN,IAAI,CAACI,YAAY;QAACG,OAAO,EAAC,IAAI,CAACA,OAAO;QAACC,SAAS,EAAC,IAAI,CAACA,SAAS;QAACC,GAAG,EAAC,IAAI,CAACA,GAAG;QAACC,IAAI,EAAC,IAAI,CAACV,IAAI,CAACW,aAAa,GAAC,WAAW,GAAC;MAAkB,CAAC,CAAC;MAAC,IAAG,CAAC/B,CAAC,EAAC,MAAM,IAAIQ,CAAC,CAAC,iCAAiC,CAAC;MAAC,OAAOR,CAAC;IAAA,CAAC,QAAMA,CAAC,EAAC;MAAC,MAAMU,CAAC,CAACV,CAAC,CAAC;IAAA;EAAC;EAAC,MAAMgC,IAAIA,CAAA,EAAE;IAAC,IAAG,CAAC,IAAI,CAACT,GAAG,EAAC,MAAM,IAAIf,CAAC,CAAC,+BAA+B,CAAC;IAAC,IAAG;MAAC,OAAO,MAAM,IAAI,CAACe,GAAG,CAACE,IAAI,CAACX,CAAC,EAAC;QAACY,aAAa,EAAC,IAAI,CAACN,IAAI,CAACI,YAAY;QAACG,OAAO,EAAC,IAAI,CAACA,OAAO;QAACC,SAAS,EAAC,IAAI,CAACA,SAAS;QAACC,GAAG,EAAC,IAAI,CAACA;MAAG,CAAC,CAAC;IAAA,CAAC,QAAM7B,CAAC,EAAC;MAAC,MAAMU,CAAC,CAACV,CAAC,CAAC;IAAA;EAAC;EAAC,MAAMiC,iBAAiBA,CAAA,EAAE;IAAC,IAAG,CAAC,IAAI,CAACV,GAAG,EAAC,MAAM,IAAIf,CAAC,CAAC,+BAA+B,CAAC;IAAC,IAAIF,CAAC,GAAC,MAAM,IAAI,CAACiB,GAAG,CAACE,IAAI,CAACT,CAAC,EAAC;MAACkB,KAAK,EAAC,IAAI,CAACC;IAAY,CAAC,CAAC;IAACnC,CAAC,IAAE,CAACE,CAAC,IAAEI,CAAC,CAAC8B,WAAW,IAAEhC,CAAC,CAACE,CAAC,CAAC8B,WAAW,EAAC,QAAQ,CAAC,EAAC,IAAI,CAACf,KAAK,GAAC;MAAC,GAAG,IAAI,CAACA,KAAK;MAACgB,UAAU,EAAC/B,CAAC,CAAC8B,WAAW;MAACZ,YAAY,EAAClB,CAAC,CAACoB;IAAa,CAAC;EAAA;EAAC,MAAMY,0BAA0BA,CAAA,EAAE;IAAC,IAAG,CAAC,IAAI,CAACf,GAAG,EAAC,MAAM,IAAIf,CAAC,CAAC,+BAA+B,CAAC;IAAC,MAAM,IAAI,CAAC+B,gBAAgB,CAACC,OAAO,CAAC,CAAC;EAAA;EAAC,MAAMC,aAAaA,CAAA,EAAE;IAAC,IAAG,CAAC,IAAI,CAAClB,GAAG,EAAC,MAAM,IAAIf,CAAC,CAAC,+BAA+B,CAAC;IAAC,IAAG,CAAC,IAAI,CAACY,IAAI,CAACI,YAAY,EAAC,MAAM,IAAIhB,CAAC,CAAC,qCAAqC,CAAC;IAAC,IAAIR,CAAC,GAAC,MAAM,IAAI,CAACuB,GAAG,CAACmB,GAAG,CAACxB,CAAC,EAAC;MAACyB,OAAO,EAAC;QAAC,yBAAyB,EAAC,IAAI,CAACvB,IAAI,CAACI;MAAY;IAAC,CAAC,CAAC;IAAC,OAAM,WAAW,KAAGxB,CAAC,CAAC4C,KAAK,KAAG,IAAI,CAACjB,OAAO,GAAC3B,CAAC,CAAC2B,OAAO,EAAC,IAAI,CAACC,SAAS,GAAC5B,CAAC,CAAC4B,SAAS,EAAC,IAAI,CAACC,GAAG,GAAC7B,CAAC,CAAC6B,GAAG,EAAC,CAAC,CAAC,CAAC;EAAA;EAACgB,WAAWA,CAAC7C,CAAC,EAACE,CAAC,GAAC,CAAC,CAAC,EAAC;IAAC,IAAI,CAACmB,KAAK,GAAC;MAACU,aAAa,EAAC,CAAC;IAAC,CAAC,EAAC,IAAI,CAACI,YAAY,GAACnC,CAAC,EAAC,IAAI,CAACuC,gBAAgB,GAAC,IAAIjC,CAAC,CAAC,IAAI,CAAC2B,iBAAiB,CAACa,IAAI,CAAC,IAAI,CAAC,CAAC,EAAC,IAAI,CAACC,YAAY,GAAC,IAAIzC,CAAC,CAAC,IAAI,CAACmC,aAAa,CAACK,IAAI,CAAC,IAAI,CAAC,CAAC,EAAC,IAAI,CAACzB,KAAK,CAACU,aAAa,GAAC7B,CAAC;EAAA;AAAC;AAAC,SAAOiB,CAAC,IAAI6B,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}