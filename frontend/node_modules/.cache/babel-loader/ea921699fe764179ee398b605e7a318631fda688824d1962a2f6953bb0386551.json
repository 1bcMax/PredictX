{"ast":null,"code":"import { PrivyClientError as e, formatApiError as t, PrivyErrorCode as a } from \"../errors.mjs\";\nimport { CaptchaError as r } from \"../hooks/captcha-context.mjs\";\nimport { telegramAccountAuthenticatePath as i, telegramAccountLinkPath as o } from \"../paths.mjs\";\nimport \"ofetch\";\nimport \"react/jsx-runtime\";\nimport \"../hooks/index.mjs\";\nimport \"react\";\nimport \"../utils/index.mjs\";\nimport \"../connectors/get-legacy-injected-providers.mjs\";\nimport \"../connectors/is-wallet-installed.mjs\";\nimport \"../utils/eth/getPublicClient.mjs\";\nimport \"viem\";\nclass n {\n  async authenticate() {\n    if (!this.api) throw new e(\"Auth flow has no API instance\");\n    try {\n      return await this.api.post(i, {\n        captcha_token: this.meta.captchaToken,\n        telegram_auth_result: this.meta.telegramAuthResult,\n        telegram_web_app_data: this.meta.telegramWebAppData,\n        mode: this.meta.disableSignup ? \"no-signup\" : \"login-or-sign-up\"\n      });\n    } catch (e) {\n      throw t(e);\n    }\n  }\n  async link() {\n    if (!this.api) throw new e(\"Auth flow has no API instance\");\n    try {\n      return await this.api.post(o, {\n        telegram_auth_result: this.meta.telegramAuthResult,\n        telegram_web_app_data: this.meta.telegramWebAppData\n      });\n    } catch (e) {\n      throw t(e);\n    }\n  }\n  constructor(e, t = !1) {\n    this.meta = {\n      disableSignup: !1\n    }, this.meta = {\n      captchaToken: e,\n      disableSignup: !1\n    }, this.meta.disableSignup = t;\n  }\n}\nfunction s(e) {\n  let t = {\n    detail: \"\",\n    retryable: !1\n  };\n  return e?.privyErrorCode === a.LINKED_TO_ANOTHER_USER && (t.detail = \"This account has already been linked to another user.\"), e?.privyErrorCode === a.DISALLOWED_LOGIN_METHOD && (t.detail = \"Login with Telegram not allowed.\"), e?.privyErrorCode === a.INVALID_DATA && (t.retryable = !0, t.detail = \"Something went wrong. Try again.\"), e?.privyErrorCode === a.CANNOT_LINK_MORE_OF_TYPE && (t.retryable = !0, t.detail = \"Something went wrong. Try again.\"), e?.privyErrorCode === a.INVALID_CREDENTIALS && (t.retryable = !0, t.detail = \"Something went wrong. Try again.\"), e?.privyErrorCode === a.TOO_MANY_REQUESTS && (t.detail = \"Too many requests. Please wait before trying again.\"), e?.privyErrorCode === a.TOO_MANY_REQUESTS && e.message.includes(\"rate limit\") && (t.detail = \"Request limit reached for Telegram. Please wait a moment and try again.\"), e instanceof r && (t.retryable = !0, t.detail = \"Something went wrong. Try again.\"), t;\n}\nfunction l() {\n  let e;\n  return (e = function () {\n    let e = new URLSearchParams(window.location.search),\n      t = Number(e.get(\"id\") || \"\"),\n      a = e.get(\"hash\"),\n      r = Number(e.get(\"auth_date\") || \"\"),\n      i = e.get(\"first_name\");\n    if (t && i && r && a) return Object.fromEntries(e.entries());\n  }()) ? (h(), {\n    flowType: \"login-url\",\n    authData: e\n  }) : (e = function () {\n    let e = window.location.hash;\n    if (!e || !e.startsWith(\"#tgWebAppData\")) return;\n    let t = m(e.replace(\"#tgWebAppData=\", \"\")),\n      {\n        user: a,\n        auth_date: r,\n        hash: i\n      } = t;\n    return a && r && i ? t : void 0;\n  }()) ? (h(), {\n    flowType: \"web-app\",\n    authData: e\n  }) : void 0;\n}\nfunction m(e) {\n  return Object.fromEntries(decodeURIComponent(e).split(\"&\").map(e => e.split(\"=\").map(decodeURIComponent)));\n}\nfunction h() {\n  let e = new URL(window.location.href);\n  e.searchParams.delete(\"id\"), e.searchParams.delete(\"hash\"), e.searchParams.delete(\"auth_date\"), e.searchParams.delete(\"first_name\"), e.searchParams.delete(\"last_name\"), e.searchParams.delete(\"username\"), e.searchParams.delete(\"photo_url\"), e.hash = \"\", window.history.replaceState({}, \"\", e);\n}\nexport { n as TelegramAuthFlow, m as convertInitDataRawToTelegramWebAppData, l as detectCompletingTelegramFlow, s as getTelegramAuthErrorMessage };","map":{"version":3,"names":["PrivyClientError","e","formatApiError","t","PrivyErrorCode","a","CaptchaError","r","telegramAccountAuthenticatePath","i","telegramAccountLinkPath","o","n","authenticate","api","post","captcha_token","meta","captchaToken","telegram_auth_result","telegramAuthResult","telegram_web_app_data","telegramWebAppData","mode","disableSignup","link","constructor","s","detail","retryable","privyErrorCode","LINKED_TO_ANOTHER_USER","DISALLOWED_LOGIN_METHOD","INVALID_DATA","CANNOT_LINK_MORE_OF_TYPE","INVALID_CREDENTIALS","TOO_MANY_REQUESTS","message","includes","l","URLSearchParams","window","location","search","Number","get","Object","fromEntries","entries","h","flowType","authData","hash","startsWith","m","replace","user","auth_date","decodeURIComponent","split","map","URL","href","searchParams","delete","history","replaceState","TelegramAuthFlow","convertInitDataRawToTelegramWebAppData","detectCompletingTelegramFlow","getTelegramAuthErrorMessage"],"sources":["/Users/vickyfu/Documents/PredictX/frontend/node_modules/@privy-io/react-auth/dist/esm/auth-flows/telegram.mjs"],"sourcesContent":["import{PrivyClientError as e,formatApiError as t,PrivyErrorCode as a}from\"../errors.mjs\";import{CaptchaError as r}from\"../hooks/captcha-context.mjs\";import{telegramAccountAuthenticatePath as i,telegramAccountLinkPath as o}from\"../paths.mjs\";import\"ofetch\";import\"react/jsx-runtime\";import\"../hooks/index.mjs\";import\"react\";import\"../utils/index.mjs\";import\"../connectors/get-legacy-injected-providers.mjs\";import\"../connectors/is-wallet-installed.mjs\";import\"../utils/eth/getPublicClient.mjs\";import\"viem\";class n{async authenticate(){if(!this.api)throw new e(\"Auth flow has no API instance\");try{return await this.api.post(i,{captcha_token:this.meta.captchaToken,telegram_auth_result:this.meta.telegramAuthResult,telegram_web_app_data:this.meta.telegramWebAppData,mode:this.meta.disableSignup?\"no-signup\":\"login-or-sign-up\"})}catch(e){throw t(e)}}async link(){if(!this.api)throw new e(\"Auth flow has no API instance\");try{return await this.api.post(o,{telegram_auth_result:this.meta.telegramAuthResult,telegram_web_app_data:this.meta.telegramWebAppData})}catch(e){throw t(e)}}constructor(e,t=!1){this.meta={disableSignup:!1},this.meta={captchaToken:e,disableSignup:!1},this.meta.disableSignup=t}}function s(e){let t={detail:\"\",retryable:!1};return e?.privyErrorCode===a.LINKED_TO_ANOTHER_USER&&(t.detail=\"This account has already been linked to another user.\"),e?.privyErrorCode===a.DISALLOWED_LOGIN_METHOD&&(t.detail=\"Login with Telegram not allowed.\"),e?.privyErrorCode===a.INVALID_DATA&&(t.retryable=!0,t.detail=\"Something went wrong. Try again.\"),e?.privyErrorCode===a.CANNOT_LINK_MORE_OF_TYPE&&(t.retryable=!0,t.detail=\"Something went wrong. Try again.\"),e?.privyErrorCode===a.INVALID_CREDENTIALS&&(t.retryable=!0,t.detail=\"Something went wrong. Try again.\"),e?.privyErrorCode===a.TOO_MANY_REQUESTS&&(t.detail=\"Too many requests. Please wait before trying again.\"),e?.privyErrorCode===a.TOO_MANY_REQUESTS&&e.message.includes(\"rate limit\")&&(t.detail=\"Request limit reached for Telegram. Please wait a moment and try again.\"),e instanceof r&&(t.retryable=!0,t.detail=\"Something went wrong. Try again.\"),t}function l(){let e;return(e=function(){let e=new URLSearchParams(window.location.search),t=Number(e.get(\"id\")||\"\"),a=e.get(\"hash\"),r=Number(e.get(\"auth_date\")||\"\"),i=e.get(\"first_name\");if(t&&i&&r&&a)return Object.fromEntries(e.entries())}())?(h(),{flowType:\"login-url\",authData:e}):(e=function(){let e=window.location.hash;if(!e||!e.startsWith(\"#tgWebAppData\"))return;let t=m(e.replace(\"#tgWebAppData=\",\"\")),{user:a,auth_date:r,hash:i}=t;return a&&r&&i?t:void 0}())?(h(),{flowType:\"web-app\",authData:e}):void 0}function m(e){return Object.fromEntries(decodeURIComponent(e).split(\"&\").map((e=>e.split(\"=\").map(decodeURIComponent))))}function h(){let e=new URL(window.location.href);e.searchParams.delete(\"id\"),e.searchParams.delete(\"hash\"),e.searchParams.delete(\"auth_date\"),e.searchParams.delete(\"first_name\"),e.searchParams.delete(\"last_name\"),e.searchParams.delete(\"username\"),e.searchParams.delete(\"photo_url\"),e.hash=\"\",window.history.replaceState({},\"\",e)}export{n as TelegramAuthFlow,m as convertInitDataRawToTelegramWebAppData,l as detectCompletingTelegramFlow,s as getTelegramAuthErrorMessage};\n"],"mappings":"AAAA,SAAOA,gBAAgB,IAAIC,CAAC,EAACC,cAAc,IAAIC,CAAC,EAACC,cAAc,IAAIC,CAAC,QAAK,eAAe;AAAC,SAAOC,YAAY,IAAIC,CAAC,QAAK,8BAA8B;AAAC,SAAOC,+BAA+B,IAAIC,CAAC,EAACC,uBAAuB,IAAIC,CAAC,QAAK,cAAc;AAAC,OAAM,QAAQ;AAAC,OAAM,mBAAmB;AAAC,OAAM,oBAAoB;AAAC,OAAM,OAAO;AAAC,OAAM,oBAAoB;AAAC,OAAM,iDAAiD;AAAC,OAAM,uCAAuC;AAAC,OAAM,kCAAkC;AAAC,OAAM,MAAM;AAAC,MAAMC,CAAC;EAAC,MAAMC,YAAYA,CAAA,EAAE;IAAC,IAAG,CAAC,IAAI,CAACC,GAAG,EAAC,MAAM,IAAIb,CAAC,CAAC,+BAA+B,CAAC;IAAC,IAAG;MAAC,OAAO,MAAM,IAAI,CAACa,GAAG,CAACC,IAAI,CAACN,CAAC,EAAC;QAACO,aAAa,EAAC,IAAI,CAACC,IAAI,CAACC,YAAY;QAACC,oBAAoB,EAAC,IAAI,CAACF,IAAI,CAACG,kBAAkB;QAACC,qBAAqB,EAAC,IAAI,CAACJ,IAAI,CAACK,kBAAkB;QAACC,IAAI,EAAC,IAAI,CAACN,IAAI,CAACO,aAAa,GAAC,WAAW,GAAC;MAAkB,CAAC,CAAC;IAAA,CAAC,QAAMvB,CAAC,EAAC;MAAC,MAAME,CAAC,CAACF,CAAC,CAAC;IAAA;EAAC;EAAC,MAAMwB,IAAIA,CAAA,EAAE;IAAC,IAAG,CAAC,IAAI,CAACX,GAAG,EAAC,MAAM,IAAIb,CAAC,CAAC,+BAA+B,CAAC;IAAC,IAAG;MAAC,OAAO,MAAM,IAAI,CAACa,GAAG,CAACC,IAAI,CAACJ,CAAC,EAAC;QAACQ,oBAAoB,EAAC,IAAI,CAACF,IAAI,CAACG,kBAAkB;QAACC,qBAAqB,EAAC,IAAI,CAACJ,IAAI,CAACK;MAAkB,CAAC,CAAC;IAAA,CAAC,QAAMrB,CAAC,EAAC;MAAC,MAAME,CAAC,CAACF,CAAC,CAAC;IAAA;EAAC;EAACyB,WAAWA,CAACzB,CAAC,EAACE,CAAC,GAAC,CAAC,CAAC,EAAC;IAAC,IAAI,CAACc,IAAI,GAAC;MAACO,aAAa,EAAC,CAAC;IAAC,CAAC,EAAC,IAAI,CAACP,IAAI,GAAC;MAACC,YAAY,EAACjB,CAAC;MAACuB,aAAa,EAAC,CAAC;IAAC,CAAC,EAAC,IAAI,CAACP,IAAI,CAACO,aAAa,GAACrB,CAAC;EAAA;AAAC;AAAC,SAASwB,CAACA,CAAC1B,CAAC,EAAC;EAAC,IAAIE,CAAC,GAAC;IAACyB,MAAM,EAAC,EAAE;IAACC,SAAS,EAAC,CAAC;EAAC,CAAC;EAAC,OAAO5B,CAAC,EAAE6B,cAAc,KAAGzB,CAAC,CAAC0B,sBAAsB,KAAG5B,CAAC,CAACyB,MAAM,GAAC,uDAAuD,CAAC,EAAC3B,CAAC,EAAE6B,cAAc,KAAGzB,CAAC,CAAC2B,uBAAuB,KAAG7B,CAAC,CAACyB,MAAM,GAAC,kCAAkC,CAAC,EAAC3B,CAAC,EAAE6B,cAAc,KAAGzB,CAAC,CAAC4B,YAAY,KAAG9B,CAAC,CAAC0B,SAAS,GAAC,CAAC,CAAC,EAAC1B,CAAC,CAACyB,MAAM,GAAC,kCAAkC,CAAC,EAAC3B,CAAC,EAAE6B,cAAc,KAAGzB,CAAC,CAAC6B,wBAAwB,KAAG/B,CAAC,CAAC0B,SAAS,GAAC,CAAC,CAAC,EAAC1B,CAAC,CAACyB,MAAM,GAAC,kCAAkC,CAAC,EAAC3B,CAAC,EAAE6B,cAAc,KAAGzB,CAAC,CAAC8B,mBAAmB,KAAGhC,CAAC,CAAC0B,SAAS,GAAC,CAAC,CAAC,EAAC1B,CAAC,CAACyB,MAAM,GAAC,kCAAkC,CAAC,EAAC3B,CAAC,EAAE6B,cAAc,KAAGzB,CAAC,CAAC+B,iBAAiB,KAAGjC,CAAC,CAACyB,MAAM,GAAC,qDAAqD,CAAC,EAAC3B,CAAC,EAAE6B,cAAc,KAAGzB,CAAC,CAAC+B,iBAAiB,IAAEnC,CAAC,CAACoC,OAAO,CAACC,QAAQ,CAAC,YAAY,CAAC,KAAGnC,CAAC,CAACyB,MAAM,GAAC,yEAAyE,CAAC,EAAC3B,CAAC,YAAYM,CAAC,KAAGJ,CAAC,CAAC0B,SAAS,GAAC,CAAC,CAAC,EAAC1B,CAAC,CAACyB,MAAM,GAAC,kCAAkC,CAAC,EAACzB,CAAC;AAAA;AAAC,SAASoC,CAACA,CAAA,EAAE;EAAC,IAAItC,CAAC;EAAC,OAAM,CAACA,CAAC,GAAC,YAAU;IAAC,IAAIA,CAAC,GAAC,IAAIuC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;MAACxC,CAAC,GAACyC,MAAM,CAAC3C,CAAC,CAAC4C,GAAG,CAAC,IAAI,CAAC,IAAE,EAAE,CAAC;MAACxC,CAAC,GAACJ,CAAC,CAAC4C,GAAG,CAAC,MAAM,CAAC;MAACtC,CAAC,GAACqC,MAAM,CAAC3C,CAAC,CAAC4C,GAAG,CAAC,WAAW,CAAC,IAAE,EAAE,CAAC;MAACpC,CAAC,GAACR,CAAC,CAAC4C,GAAG,CAAC,YAAY,CAAC;IAAC,IAAG1C,CAAC,IAAEM,CAAC,IAAEF,CAAC,IAAEF,CAAC,EAAC,OAAOyC,MAAM,CAACC,WAAW,CAAC9C,CAAC,CAAC+C,OAAO,CAAC,CAAC,CAAC;EAAA,CAAC,CAAC,CAAC,KAAGC,CAAC,CAAC,CAAC,EAAC;IAACC,QAAQ,EAAC,WAAW;IAACC,QAAQ,EAAClD;EAAC,CAAC,IAAE,CAACA,CAAC,GAAC,YAAU;IAAC,IAAIA,CAAC,GAACwC,MAAM,CAACC,QAAQ,CAACU,IAAI;IAAC,IAAG,CAACnD,CAAC,IAAE,CAACA,CAAC,CAACoD,UAAU,CAAC,eAAe,CAAC,EAAC;IAAO,IAAIlD,CAAC,GAACmD,CAAC,CAACrD,CAAC,CAACsD,OAAO,CAAC,gBAAgB,EAAC,EAAE,CAAC,CAAC;MAAC;QAACC,IAAI,EAACnD,CAAC;QAACoD,SAAS,EAAClD,CAAC;QAAC6C,IAAI,EAAC3C;MAAC,CAAC,GAACN,CAAC;IAAC,OAAOE,CAAC,IAAEE,CAAC,IAAEE,CAAC,GAACN,CAAC,GAAC,KAAK,CAAC;EAAA,CAAC,CAAC,CAAC,KAAG8C,CAAC,CAAC,CAAC,EAAC;IAACC,QAAQ,EAAC,SAAS;IAACC,QAAQ,EAAClD;EAAC,CAAC,IAAE,KAAK,CAAC;AAAA;AAAC,SAASqD,CAACA,CAACrD,CAAC,EAAC;EAAC,OAAO6C,MAAM,CAACC,WAAW,CAACW,kBAAkB,CAACzD,CAAC,CAAC,CAAC0D,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAAE3D,CAAC,IAAEA,CAAC,CAAC0D,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAACF,kBAAkB,CAAE,CAAC,CAAC;AAAA;AAAC,SAAST,CAACA,CAAA,EAAE;EAAC,IAAIhD,CAAC,GAAC,IAAI4D,GAAG,CAACpB,MAAM,CAACC,QAAQ,CAACoB,IAAI,CAAC;EAAC7D,CAAC,CAAC8D,YAAY,CAACC,MAAM,CAAC,IAAI,CAAC,EAAC/D,CAAC,CAAC8D,YAAY,CAACC,MAAM,CAAC,MAAM,CAAC,EAAC/D,CAAC,CAAC8D,YAAY,CAACC,MAAM,CAAC,WAAW,CAAC,EAAC/D,CAAC,CAAC8D,YAAY,CAACC,MAAM,CAAC,YAAY,CAAC,EAAC/D,CAAC,CAAC8D,YAAY,CAACC,MAAM,CAAC,WAAW,CAAC,EAAC/D,CAAC,CAAC8D,YAAY,CAACC,MAAM,CAAC,UAAU,CAAC,EAAC/D,CAAC,CAAC8D,YAAY,CAACC,MAAM,CAAC,WAAW,CAAC,EAAC/D,CAAC,CAACmD,IAAI,GAAC,EAAE,EAACX,MAAM,CAACwB,OAAO,CAACC,YAAY,CAAC,CAAC,CAAC,EAAC,EAAE,EAACjE,CAAC,CAAC;AAAA;AAAC,SAAOW,CAAC,IAAIuD,gBAAgB,EAACb,CAAC,IAAIc,sCAAsC,EAAC7B,CAAC,IAAI8B,4BAA4B,EAAC1C,CAAC,IAAI2C,2BAA2B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}