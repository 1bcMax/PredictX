{"ast":null,"code":"import { RunEffectOnce as e } from \"../effect.mjs\";\nimport { PrivyClientError as t, formatApiError as i } from \"../errors.mjs\";\nimport { prepareSiweMessageWithNonce as n } from \"../lib/siwe.mjs\";\nimport \"ofetch\";\nclass s {\n  get meta() {\n    return {\n      connectorType: this.wallet.connectorType,\n      walletClientType: this.wallet.walletClientType,\n      chainId: this.wallet.chainId,\n      address: this.wallet.address,\n      disableSignup: this._meta.disableSignup\n    };\n  }\n  async authenticate() {\n    if (!this.client) throw new t(\"SiweFlow has no client instance\");\n    try {\n      let {\n        message: e,\n        signature: t\n      } = await this.sign();\n      return await this.client.authenticateWithSiweInternal({\n        message: e,\n        signature: t,\n        chainId: this.wallet.chainId,\n        walletClientType: this.wallet.walletClientType,\n        connectorType: this.wallet.connectorType,\n        mode: this.meta.disableSignup ? \"no-signup\" : \"login-or-sign-up\"\n      });\n    } catch (e) {\n      throw i(e);\n    }\n  }\n  async link() {\n    if (!this.client) throw new t(\"SiweFlow has no client instance\");\n    try {\n      let {\n        message: e,\n        signature: t\n      } = await this.sign();\n      return await this.client.linkWithSiweInternal({\n        message: e,\n        signature: t,\n        chainId: this.wallet.chainId,\n        walletClientType: this.wallet.walletClientType,\n        connectorType: this.wallet.connectorType\n      });\n    } catch (e) {\n      throw i(e);\n    }\n  }\n  async sign() {\n    if (!this.client) throw new t(\"SiweFlow has no client instance\");\n    if (await this.buildMessage(), !this.preparedMessage) throw new t(\"Could not prepare SIWE message\");\n    let e = await this.wallet.sign(this.preparedMessage);\n    return {\n      message: this.preparedMessage,\n      signature: e\n    };\n  }\n  async _getNonceOnce() {\n    if (!this.client) throw new t(\"SiweFlow has no client instance\");\n    return await this.client.generateSiweNonce({\n      address: this.wallet.address,\n      captchaToken: this.captchaToken\n    });\n  }\n  async buildMessage() {\n    if (!this.client) throw new t(\"SiweFlow has no client instance\");\n    let e = this.wallet.address,\n      i = this.wallet.chainId.replace(\"eip155:\", \"\");\n    return this.nonce || (this.nonce = await this.getNonceOnce.execute()), this.preparedMessage = n({\n      address: e,\n      chainId: i,\n      nonce: this.nonce\n    }), this.preparedMessage;\n  }\n  constructor(t, i, n, s = !1) {\n    this._meta = {\n      disableSignup: !1\n    }, this.getNonceOnce = new e(this._getNonceOnce.bind(this)), this.wallet = t, this.captchaToken = n, this.client = i, this._meta.disableSignup = s;\n  }\n}\nexport { s as SiweFlow };","map":{"version":3,"names":["RunEffectOnce","e","PrivyClientError","t","formatApiError","i","prepareSiweMessageWithNonce","n","s","meta","connectorType","wallet","walletClientType","chainId","address","disableSignup","_meta","authenticate","client","message","signature","sign","authenticateWithSiweInternal","mode","link","linkWithSiweInternal","buildMessage","preparedMessage","_getNonceOnce","generateSiweNonce","captchaToken","replace","nonce","getNonceOnce","execute","constructor","bind","SiweFlow"],"sources":["/Users/vickyfu/Documents/PredictX/frontend/node_modules/@privy-io/react-auth/dist/esm/auth-flows/siwe.mjs"],"sourcesContent":["import{RunEffectOnce as e}from\"../effect.mjs\";import{PrivyClientError as t,formatApiError as i}from\"../errors.mjs\";import{prepareSiweMessageWithNonce as n}from\"../lib/siwe.mjs\";import\"ofetch\";class s{get meta(){return{connectorType:this.wallet.connectorType,walletClientType:this.wallet.walletClientType,chainId:this.wallet.chainId,address:this.wallet.address,disableSignup:this._meta.disableSignup}}async authenticate(){if(!this.client)throw new t(\"SiweFlow has no client instance\");try{let{message:e,signature:t}=await this.sign();return await this.client.authenticateWithSiweInternal({message:e,signature:t,chainId:this.wallet.chainId,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType,mode:this.meta.disableSignup?\"no-signup\":\"login-or-sign-up\"})}catch(e){throw i(e)}}async link(){if(!this.client)throw new t(\"SiweFlow has no client instance\");try{let{message:e,signature:t}=await this.sign();return await this.client.linkWithSiweInternal({message:e,signature:t,chainId:this.wallet.chainId,walletClientType:this.wallet.walletClientType,connectorType:this.wallet.connectorType})}catch(e){throw i(e)}}async sign(){if(!this.client)throw new t(\"SiweFlow has no client instance\");if(await this.buildMessage(),!this.preparedMessage)throw new t(\"Could not prepare SIWE message\");let e=await this.wallet.sign(this.preparedMessage);return{message:this.preparedMessage,signature:e}}async _getNonceOnce(){if(!this.client)throw new t(\"SiweFlow has no client instance\");return await this.client.generateSiweNonce({address:this.wallet.address,captchaToken:this.captchaToken})}async buildMessage(){if(!this.client)throw new t(\"SiweFlow has no client instance\");let e=this.wallet.address,i=this.wallet.chainId.replace(\"eip155:\",\"\");return this.nonce||(this.nonce=await this.getNonceOnce.execute()),this.preparedMessage=n({address:e,chainId:i,nonce:this.nonce}),this.preparedMessage}constructor(t,i,n,s=!1){this._meta={disableSignup:!1},this.getNonceOnce=new e(this._getNonceOnce.bind(this)),this.wallet=t,this.captchaToken=n,this.client=i,this._meta.disableSignup=s}}export{s as SiweFlow};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}