{"ast":null,"code":"import { PrivyClientError as r } from \"../../../../Error.mjs\";\nimport { getCrossAppAccountByWalletAddress as e } from \"./getCrossAppAccountByWalletAddress.mjs\";\nimport { getProviderAccessTokenOrRelink as o } from \"./getProviderAccessTokenOrRelink.mjs\";\nimport \"../../linkWithCrossAppAuth.mjs\";\nconst t = ({\n  client: t,\n  openAuthSession: s\n}) => {\n  let a = o({\n    client: t,\n    openAuthSession: s\n  });\n  return async ({\n    user: o,\n    request: p,\n    redirectUrl: n,\n    address: i\n  }) => {\n    let c = e(o, i);\n    if (!c) throw new r({\n      code: \"cross_app_invalid_wallet\",\n      error: \"Cannot operate with this wallet address\"\n    });\n    let _ = c.provider_app_id,\n      {\n        connections: d\n      } = await t.crossApp.getCrossAppConnections(),\n      l = d.find(r => r.provider_app_id === _);\n    if (!l) throw new r({\n      code: \"cross_app_invalid_app\",\n      error: \"Invalid connected app\"\n    });\n    if (l.read_only) throw new r({\n      code: \"cross_app_read_only\",\n      error: \"Cannot transact against a read-only provider app\"\n    });\n    let u = await a({\n      providerAppId: _,\n      redirectUrl: n\n    });\n    if (!u) throw new r({\n      code: \"cross_app_request_error\",\n      error: \"Wallet operations require a valid token\"\n    });\n    let w = {\n        content: {\n          request: {\n            request: p\n          }\n        },\n        timestamp: Date.now(),\n        callbackUrl: n\n      },\n      m = new URL(`${l.provider_app_custom_api_url}/oauth/transact`);\n    m.searchParams.set(\"communicationMode\", \"redirect\"), m.searchParams.set(\"token\", u), m.searchParams.set(\"request\", JSON.stringify(w));\n    let {\n      privy_cross_app_type: h,\n      privy_cross_app_payload: A\n    } = await s(m.href);\n    if (!h || !A) throw new r({\n      code: \"cross_app_request_error\",\n      error: \"Cross app request returned an invalid result\"\n    });\n    if (\"PRIVY_CROSS_APP_ACTION_ERROR\" === h) throw new r({\n      code: \"cross_app_request_error\",\n      error: A\n    });\n    if (\"PRIVY_CROSS_APP_ACTION_RESPONSE\" !== h) throw new r({\n      code: \"cross_app_request_error\",\n      error: \"Cross app request returned an invalid result\"\n    });\n    return {\n      result: A\n    };\n  };\n};\nexport { t as sendCrossAppRequest };","map":{"version":3,"names":["PrivyClientError","r","getCrossAppAccountByWalletAddress","e","getProviderAccessTokenOrRelink","o","t","client","openAuthSession","s","a","user","request","p","redirectUrl","n","address","i","c","code","error","_","provider_app_id","connections","d","crossApp","getCrossAppConnections","l","find","read_only","u","providerAppId","w","content","timestamp","Date","now","callbackUrl","m","URL","provider_app_custom_api_url","searchParams","set","JSON","stringify","privy_cross_app_type","h","privy_cross_app_payload","A","href","result","sendCrossAppRequest"],"sources":["/Users/vickyfu/Documents/PredictX/frontend/node_modules/@privy-io/react-auth/node_modules/@privy-io/js-sdk-core/dist/esm/action/crossApp/wallet/utils/sendCrossAppRequest.mjs"],"sourcesContent":["import{PrivyClientError as r}from\"../../../../Error.mjs\";import{getCrossAppAccountByWalletAddress as e}from\"./getCrossAppAccountByWalletAddress.mjs\";import{getProviderAccessTokenOrRelink as o}from\"./getProviderAccessTokenOrRelink.mjs\";import\"../../linkWithCrossAppAuth.mjs\";const t=({client:t,openAuthSession:s})=>{let a=o({client:t,openAuthSession:s});return async({user:o,request:p,redirectUrl:n,address:i})=>{let c=e(o,i);if(!c)throw new r({code:\"cross_app_invalid_wallet\",error:\"Cannot operate with this wallet address\"});let _=c.provider_app_id,{connections:d}=await t.crossApp.getCrossAppConnections(),l=d.find((r=>r.provider_app_id===_));if(!l)throw new r({code:\"cross_app_invalid_app\",error:\"Invalid connected app\"});if(l.read_only)throw new r({code:\"cross_app_read_only\",error:\"Cannot transact against a read-only provider app\"});let u=await a({providerAppId:_,redirectUrl:n});if(!u)throw new r({code:\"cross_app_request_error\",error:\"Wallet operations require a valid token\"});let w={content:{request:{request:p}},timestamp:Date.now(),callbackUrl:n},m=new URL(`${l.provider_app_custom_api_url}/oauth/transact`);m.searchParams.set(\"communicationMode\",\"redirect\"),m.searchParams.set(\"token\",u),m.searchParams.set(\"request\",JSON.stringify(w));let{privy_cross_app_type:h,privy_cross_app_payload:A}=await s(m.href);if(!h||!A)throw new r({code:\"cross_app_request_error\",error:\"Cross app request returned an invalid result\"});if(\"PRIVY_CROSS_APP_ACTION_ERROR\"===h)throw new r({code:\"cross_app_request_error\",error:A});if(\"PRIVY_CROSS_APP_ACTION_RESPONSE\"!==h)throw new r({code:\"cross_app_request_error\",error:\"Cross app request returned an invalid result\"});return{result:A}}};export{t as sendCrossAppRequest};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}