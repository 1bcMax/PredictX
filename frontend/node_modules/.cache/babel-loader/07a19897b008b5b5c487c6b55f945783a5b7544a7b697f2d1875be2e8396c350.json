{"ast":null,"code":"import { CODE_VERIFIER_KEY as t, HEADLESS_OAUTH_KEY as e, OAUTH_DISABLE_SIGNUP_KEY as i, STATE_CODE_KEY as o } from \"../../constants.mjs\";\nimport { PrivyClientError as a, formatApiError as r, PrivyErrorCode as n } from \"../../errors.mjs\";\nimport { getCodeVerifier as h, createCodeVerifier as s, createStateCode as d, deriveCodeChallengeFromCodeVerifier as u } from \"../../lib/pkce.mjs\";\nimport { oAuthAuthenticatePath as m, oAuthLinkPath as c, oAuthInitPath as w } from \"../../paths.mjs\";\nimport l from \"../../storage.mjs\";\nimport { getUiHeader as p } from \"../getUiHeader.mjs\";\nimport \"ofetch\";\nimport \"jose\";\nimport \"../../crypto.mjs\";\nclass f {\n  addCaptchaToken(t) {\n    this.meta.captchaToken = t;\n  }\n  isActive() {\n    return !!(this.meta.authorizationCode && this.meta.stateCode && this.meta.provider);\n  }\n  async authenticate() {\n    if (!this.api) throw new a(\"Auth flow has no API instance\");\n    if (!this.meta.authorizationCode || !this.meta.stateCode) throw new a(\"[OAuth AuthFlow] Authorization and state codes code must be set prior to calling authenticate.\");\n    if (\"undefined\" === this.meta.authorizationCode) throw new a(\"User denied confirmation during OAuth flow\");\n    let o = h();\n    try {\n      let a = await this.api.post(m, {\n        authorization_code: this.meta.authorizationCode,\n        state_code: this.meta.stateCode,\n        code_verifier: o,\n        mode: this.meta.disableSignup ? \"no-signup\" : \"login-or-sign-up\"\n      });\n      return l.del(t), l.del(e), l.del(i), a;\n    } catch (t) {\n      let e = r(t);\n      if (e.privyErrorCode) throw new a(e.message || \"Invalid code during OAuth flow.\", void 0, e.privyErrorCode);\n      if (\"User denied confirmation during OAuth flow\" === e.message) throw new a(\"Invalid code during oauth flow.\", void 0, n.OAUTH_USER_DENIED);\n      throw new a(\"Invalid code during OAuth flow.\", void 0, n.UNKNOWN_AUTH_ERROR);\n    }\n  }\n  async link() {\n    if (!this.api) throw new a(\"Auth flow has no API instance\");\n    if (!this.meta.authorizationCode || !this.meta.stateCode) throw new a(\"[OAuth AuthFlow] Authorization and state codes code must be set prior to calling link.\");\n    if (\"undefined\" === this.meta.authorizationCode) throw new a(\"User denied confirmation during OAuth flow\");\n    let e = l.get(t);\n    if (!e) throw new a(\"Authentication error.\");\n    try {\n      let i = await this.api.post(c, {\n        authorization_code: this.meta.authorizationCode,\n        state_code: this.meta.stateCode,\n        code_verifier: e\n      });\n      return l.del(t), i;\n    } catch (t) {\n      throw r(t);\n    }\n  }\n  async getAuthorizationUrl() {\n    if (!this.api) throw new a(\"Auth flow has no API instance\");\n    if (!this.meta.provider) throw new a(\"Provider must be set when initializing OAuth authentication.\");\n    let n = s();\n    l.put(t, n);\n    let h = d();\n    l.put(o, h);\n    let m = await u(n);\n    this.meta.withPrivyUi || l.put(e, !0), this.meta.disableSignup && l.put(i, !0);\n    let c = p(this.meta.withPrivyUi);\n    try {\n      return await this.api.post(w, {\n        provider: this.meta.provider,\n        redirect_to: window.location.href,\n        token: this.meta.captchaToken,\n        code_challenge: m,\n        state_code: h\n      }, {\n        headers: {\n          ...c\n        }\n      });\n    } catch (t) {\n      throw r(t);\n    }\n  }\n  constructor(t) {\n    this.meta = t;\n  }\n}\nexport { f as OAuthFlow };","map":{"version":3,"names":["CODE_VERIFIER_KEY","t","HEADLESS_OAUTH_KEY","e","OAUTH_DISABLE_SIGNUP_KEY","i","STATE_CODE_KEY","o","PrivyClientError","a","formatApiError","r","PrivyErrorCode","n","getCodeVerifier","h","createCodeVerifier","s","createStateCode","d","deriveCodeChallengeFromCodeVerifier","u","oAuthAuthenticatePath","m","oAuthLinkPath","c","oAuthInitPath","w","l","getUiHeader","p","f","addCaptchaToken","meta","captchaToken","isActive","authorizationCode","stateCode","provider","authenticate","api","post","authorization_code","state_code","code_verifier","mode","disableSignup","del","privyErrorCode","message","OAUTH_USER_DENIED","UNKNOWN_AUTH_ERROR","link","get","getAuthorizationUrl","put","withPrivyUi","redirect_to","window","location","href","token","code_challenge","headers","constructor","OAuthFlow"],"sources":["/Users/vickyfu/Documents/PredictX/frontend/node_modules/@privy-io/react-auth/dist/esm/auth-flows/oauth/OAuthFlow.mjs"],"sourcesContent":["import{CODE_VERIFIER_KEY as t,HEADLESS_OAUTH_KEY as e,OAUTH_DISABLE_SIGNUP_KEY as i,STATE_CODE_KEY as o}from\"../../constants.mjs\";import{PrivyClientError as a,formatApiError as r,PrivyErrorCode as n}from\"../../errors.mjs\";import{getCodeVerifier as h,createCodeVerifier as s,createStateCode as d,deriveCodeChallengeFromCodeVerifier as u}from\"../../lib/pkce.mjs\";import{oAuthAuthenticatePath as m,oAuthLinkPath as c,oAuthInitPath as w}from\"../../paths.mjs\";import l from\"../../storage.mjs\";import{getUiHeader as p}from\"../getUiHeader.mjs\";import\"ofetch\";import\"jose\";import\"../../crypto.mjs\";class f{addCaptchaToken(t){this.meta.captchaToken=t}isActive(){return!!(this.meta.authorizationCode&&this.meta.stateCode&&this.meta.provider)}async authenticate(){if(!this.api)throw new a(\"Auth flow has no API instance\");if(!this.meta.authorizationCode||!this.meta.stateCode)throw new a(\"[OAuth AuthFlow] Authorization and state codes code must be set prior to calling authenticate.\");if(\"undefined\"===this.meta.authorizationCode)throw new a(\"User denied confirmation during OAuth flow\");let o=h();try{let a=await this.api.post(m,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:o,mode:this.meta.disableSignup?\"no-signup\":\"login-or-sign-up\"});return l.del(t),l.del(e),l.del(i),a}catch(t){let e=r(t);if(e.privyErrorCode)throw new a(e.message||\"Invalid code during OAuth flow.\",void 0,e.privyErrorCode);if(\"User denied confirmation during OAuth flow\"===e.message)throw new a(\"Invalid code during oauth flow.\",void 0,n.OAUTH_USER_DENIED);throw new a(\"Invalid code during OAuth flow.\",void 0,n.UNKNOWN_AUTH_ERROR)}}async link(){if(!this.api)throw new a(\"Auth flow has no API instance\");if(!this.meta.authorizationCode||!this.meta.stateCode)throw new a(\"[OAuth AuthFlow] Authorization and state codes code must be set prior to calling link.\");if(\"undefined\"===this.meta.authorizationCode)throw new a(\"User denied confirmation during OAuth flow\");let e=l.get(t);if(!e)throw new a(\"Authentication error.\");try{let i=await this.api.post(c,{authorization_code:this.meta.authorizationCode,state_code:this.meta.stateCode,code_verifier:e});return l.del(t),i}catch(t){throw r(t)}}async getAuthorizationUrl(){if(!this.api)throw new a(\"Auth flow has no API instance\");if(!this.meta.provider)throw new a(\"Provider must be set when initializing OAuth authentication.\");let n=s();l.put(t,n);let h=d();l.put(o,h);let m=await u(n);this.meta.withPrivyUi||l.put(e,!0),this.meta.disableSignup&&l.put(i,!0);let c=p(this.meta.withPrivyUi);try{return await this.api.post(w,{provider:this.meta.provider,redirect_to:window.location.href,token:this.meta.captchaToken,code_challenge:m,state_code:h},{headers:{...c}})}catch(t){throw r(t)}}constructor(t){this.meta=t}}export{f as OAuthFlow};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}